name: Build

on:
  workflow_dispatch:
jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout latest code
        uses: actions/checkout@v1
      - name: Checkout secrets
        uses: actions/checkout@v2
        with:
          repository: 'herowio/herow-api-secrets'
          token: ${{ secrets.PAT_READ_PRIVATE_REPO }}
          path: secrets
      - name: copy platform-secrets.properties
        run: cp secrets/platform-secrets.properties ./platform-secrets.properties
      - name: set up JDK 1.8
        uses: actions/setup-java@v1
        with:
          java-version: 1.8
      - name: Publish artifact
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: bash ./gradlew clean publish
